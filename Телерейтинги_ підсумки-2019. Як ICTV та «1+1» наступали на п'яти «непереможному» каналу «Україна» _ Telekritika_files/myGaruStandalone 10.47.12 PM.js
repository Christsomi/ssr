//2.1.4
(()=>{window.mygaru=window.mygaru||{};var i=window.mygaru;i.cmd=i.cmd||[];i.cmd.push=s;function s(...t){return t.forEach((r)=>{try{r&&r()}catch(n){console.error("Error executing que function",n)}}),t.length}function d(){if(i.cmd.length)for(let t=0;t<i.cmd.length;t++){let r=i.cmd[t];if(r&&typeof r==="function")s(r)}}function u(t){let r=new URL("https://ident.mygaru.com/v2/id");return r.searchParams.append("partner_id",t),fetch(r.toString(),{method:"GET",credentials:"include"}).then((n)=>n.json()).then(({otp:n})=>{return n})}function g(){try{return window.location.hostname}catch(t){return"unknown.com"}}function h(t){let r={domain:g(),otp:t.otp,ttems:t.tteMS,err:t.error?t.error:void 0,i:"myg-standalone"},n=new URL("https://tracking.mygaru.com"+t.resource);Object.entries(r).forEach(([w,c])=>{if(c!==void 0)n.searchParams.append(w,String(c))}),fetch(n.toString(),{method:"GET",credentials:"include"}).catch(()=>{})}function e(t){try{if(window.googletag=window.googletag||{},!googletag.secureSignalProviders)googletag.secureSignalProviders=[];googletag.secureSignalProviders.push({id:"mygaruID",collectorFunction:()=>t})}catch(r){}}function m(){if(window.performance&&window.performance.now)return window.performance.now();return Date.now()}class o{partnerId;token;initPromiseCache=null;constructor(t){if(!t)throw new Error("partnerId is required");return this.partnerId=t,this.token="",this}ident({emitSecureSignals:t}={}){let r=m();if(this.initPromiseCache=u(this.partnerId).then((n)=>{this.token=n,h({otp:n,tteMS:Math.round(m()-r),resource:"/ident/"})}).then(()=>{return this.token}).catch((n)=>{throw h({otp:"0",error:n.message,tteMS:Math.round(m()-r),resource:"/ident/"}),n}),t)e(this.initPromiseCache);return this.initPromiseCache}emitSecureSignals(){if(!this.initPromiseCache)throw new Error("ident must be called first");e(this.initPromiseCache)}}var f=!1;i.init=(t)=>{return f=!0,new o(t)};function a(){if(window.location.href.indexOf("helsi.me")>-1)return;if(f)return;let n=new o("abd6fad8-5220-4364-8fd1-052f78594be6").ident();e(n)}(()=>{d(),a()})();})();
